---

title: Title


keywords: fastai
sidebar: home_sidebar



nb_path: "projects/m5/training_day_by_day_models.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: projects/m5/training_day_by_day_models.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="-"> <a class="anchor-link" href="#-"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="main" class="doc_header"><code>main</code><a href="https://github.com/ChrisRichardMiles/chrisrichardmiles/tree/master/chrisrichardmiles/m5/daily_models.py#L28" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>main</code>(<strong><code>path_cfg</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="lgb_daily" class="doc_header"><code>lgb_daily</code><a href="https://github.com/ChrisRichardMiles/chrisrichardmiles/tree/master/chrisrichardmiles/m5/daily_models.py#L216" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>lgb_daily</code>(<strong><code>path_cfg</code></strong>:"path to the configuration json"=<em><code>'cfg.json'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lgb_daily</span><span class="p">(</span><span class="s1">&#39;final_cfg.json&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>No data was loaded
Training until validation scores don&#39;t improve for 50 rounds
Early stopping, best iteration is:
[1]	valid&#39;s l2: 1.20148	valid&#39;s mse_feval_scale: 1.30647	test&#39;s l2: 1.54952	test&#39;s mse_feval_scale: 1.54952
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/chrisrichardmiles/miniconda3/lib/python3.9/site-packages/lightgbm/engine.py:177: UserWarning: Found `n_estimators` in params. Will use it instead of argument
  _log_warning(f&#34;Found `{alias}` in params. Will use it instead of argument&#34;)
/home/chrisrichardmiles/miniconda3/lib/python3.9/site-packages/lightgbm/engine.py:239: UserWarning: &#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. Pass &#39;log_evaluation()&#39; callback via &#39;callbacks&#39; argument instead.
  _log_warning(&#34;&#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. &#34;
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_4683/970003490.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>lgb_daily<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;final_cfg.json&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/tmp/ipykernel_4683/486184396.py</span> in <span class="ansi-cyan-fg">lgb_daily</span><span class="ansi-blue-fg">(path_cfg)</span>
<span class="ansi-green-intense-fg ansi-bold">    129</span>             verbose_eval<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">500</span>
<span class="ansi-green-intense-fg ansi-bold">    130</span>         )
<span class="ansi-green-fg">--&gt; 131</span><span class="ansi-red-fg">         </span>booster_summary <span class="ansi-blue-fg">=</span> create_booster_summary<span class="ansi-blue-fg">(</span>booster<span class="ansi-blue-fg">=</span>estimator<span class="ansi-blue-fg">,</span> max_num_features<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">50</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    132</span>         booster_summary <span class="ansi-blue-fg">=</span> create_booster_summary<span class="ansi-blue-fg">(</span>booster<span class="ansi-blue-fg">=</span>estimator<span class="ansi-blue-fg">,</span> max_num_features<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">50</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    133</span>         booster_summaries<span class="ansi-blue-fg">.</span>append<span class="ansi-blue-fg">(</span>booster_summary<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/miniconda3/lib/python3.9/site-packages/neptune_lightgbm/impl/__init__.py</span> in <span class="ansi-cyan-fg">create_booster_summary</span><span class="ansi-blue-fg">(booster, log_importances, max_num_features, list_trees, log_trees_as_dataframe, log_pickled_booster, log_trees, tree_figsize, log_confusion_matrix, y_true, y_pred)</span>
<span class="ansi-green-intense-fg ansi-bold">    332</span>     visuals_path <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">&#34;visualizations/&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    333</span>     <span class="ansi-green-fg">if</span> log_importances<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 334</span><span class="ansi-red-fg">         split_plot = lgb.plot_importance(
</span><span class="ansi-green-intense-fg ansi-bold">    335</span>             booster<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    336</span>             importance_type<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#34;split&#34;</span><span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">~/miniconda3/lib/python3.9/site-packages/lightgbm/plotting.py</span> in <span class="ansi-cyan-fg">plot_importance</span><span class="ansi-blue-fg">(booster, ax, height, xlim, ylim, title, xlabel, ylabel, importance_type, max_num_features, ignore_zero, figsize, dpi, grid, precision, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    112</span> 
<span class="ansi-green-intense-fg ansi-bold">    113</span>     <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> len<span class="ansi-blue-fg">(</span>importance<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 114</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">raise</span> ValueError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;Booster&#39;s feature_importance is empty.&#34;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    115</span> 
<span class="ansi-green-intense-fg ansi-bold">    116</span>     tuples <span class="ansi-blue-fg">=</span> sorted<span class="ansi-blue-fg">(</span>zip<span class="ansi-blue-fg">(</span>feature_name<span class="ansi-blue-fg">,</span> importance<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> key<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">lambda</span> x<span class="ansi-blue-fg">:</span> x<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">ValueError</span>: Booster&#39;s feature_importance is empty.</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># df.F1.max()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Neptune-code">Neptune code<a class="anchor-link" href="#Neptune-code"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># print(os.environ.get(&#39;NEPTUNE_API_TOKEN&#39;))</span>
<span class="c1"># neptune.init()</span>
<span class="c1"># lgb.train??</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="kn">import</span> <span class="n">notebook2script</span><span class="p">;</span> <span class="n">notebook2script</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

