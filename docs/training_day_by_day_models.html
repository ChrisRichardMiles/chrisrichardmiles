---

title: Title


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/m5/training_day_by_day_models.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/m5/training_day_by_day_models.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="-"> <a class="anchor-link" href="#-"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_cfg" class="doc_header"><code>load_cfg</code><a href="https://github.com/chrisrichardmiles/chrisrichardmiles/tree/master/chrisrichardmiles/m5/daily_models.py#L31" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_cfg</code>(<strong><code>path_cfg</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cfg</span> <span class="o">=</span> <span class="n">load_cfg</span><span class="p">(</span><span class="s1">&#39;../../../final_cfg.json&#39;</span><span class="p">)</span>
<span class="n">cfg</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;start_test&#39;: 1942,
 &#39;start_train&#39;: 140,
 &#39;days_to_predict&#39;: &#39;all&#39;,
 &#39;fobj&#39;: &#39;mse&#39;,
 &#39;fobj_weight_col&#39;: &#39;total_scaled_weight&#39;,
 &#39;weight_hess&#39;: 1,
 &#39;feval&#39;: &#39;mse&#39;,
 &#39;feval_weight_col&#39;: &#39;scale&#39;,
 &#39;weight_col&#39;: None,
 &#39;lgb_params&#39;: {&#39;boosting_type&#39;: &#39;gbdt&#39;,
  &#39;subsample&#39;: 0.5,
  &#39;objective&#39;: None,
  &#39;metric&#39;: None,
  &#39;subsample_freq&#39;: 1,
  &#39;learning_rate&#39;: 0.03,
  &#39;num_leaves&#39;: 255,
  &#39;min_data_in_leaf&#39;: 255,
  &#39;feature_fraction&#39;: 0.8,
  &#39;n_estimators&#39;: 1,
  &#39;early_stopping_rounds&#39;: 50,
  &#39;device_type&#39;: &#39;cpu&#39;,
  &#39;seed&#39;: 42,
  &#39;verbose&#39;: -1},
 &#39;target&#39;: &#39;sales&#39;,
 &#39;p_horizon&#39;: 28,
 &#39;num_series&#39;: 30490,
 &#39;features_json&#39;: &#39;pkl_final_features.json&#39;,
 &#39;path_data_raw&#39;: &#39;data/raw&#39;,
 &#39;path_features&#39;: &#39;data/features&#39;,
 &#39;path_models&#39;: &#39;data/models&#39;,
 &#39;use_neptune&#39;: 0,
 &#39;neptune_project&#39;: 0,
 &#39;neptune_api_token&#39;: None}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="prep_data" class="doc_header"><code>prep_data</code><a href="https://github.com/chrisrichardmiles/chrisrichardmiles/tree/master/chrisrichardmiles/m5/daily_models.py#L37" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>prep_data</code>(<strong><code>cfg</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="neptune" class="doc_header"><code>neptune</code><a href="https://github.com/chrisrichardmiles/chrisrichardmiles/tree/master/chrisrichardmiles/m5/daily_models.py#L58" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>neptune</code>(<strong><code>cfg</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">neptune</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="lgb_daily" class="doc_header"><code>lgb_daily</code><a href="https://github.com/chrisrichardmiles/chrisrichardmiles/tree/master/chrisrichardmiles/m5/daily_models.py#L63" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>lgb_daily</code>(<strong><code>path_cfg</code></strong>:<code>str</code>=<em><code>'cfg.json'</code></em>)</p>
</blockquote>
<p>Train 1 model for each day of prediction accoring to <code>path_cfg</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="cli_lgb_daily" class="doc_header"><code>cli_lgb_daily</code><a href="https://github.com/chrisrichardmiles/chrisrichardmiles/tree/master/chrisrichardmiles/m5/daily_models.py#L164" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>cli_lgb_daily</code>(<strong><code>path_cfg</code></strong>:"path to the configuration json"=<em><code>'cfg.json'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Neptune-code">Neptune code<a class="anchor-link" href="#Neptune-code"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="kn">import</span> <span class="n">notebook2script</span><span class="p">;</span> <span class="n">notebook2script</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted 00_core.ipynb.
Converted index.ipynb.
Converted 01_brief_eda.ipynb.
Converted 02_WRMSSE_metric.ipynb.
Converted 03_feature_engineering.ipynb.
Converted 04_out_of_stock_detection.ipynb.
Converted index.ipynb.
Converted training_day_by_day_models.ipynb.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

